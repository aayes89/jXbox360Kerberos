package com.mycompany.xbox360s;

import javax.security.auth.Subject;
import javax.security.auth.login.LoginContext;
import javax.security.auth.login.LoginException;
import java.io.IOException;
import java.net.ServerSocket;
import java.net.Socket;
import java.security.Principal;

/**
 *
 * @author Slam
 */
public class Xbox360S {

    public static void main(String[] args) {
        Utils utils = new Utils();
        /*String encSData = "0000000000000002896a1dd55805b6a954ee6b1944500761409ed608e1c904b0fae6f79a1583679ad45270a9a7ab2a580547cbdb83214c7440461cb45d29ca0655dd443c5485a61c09a11e6d9f8b29347b4d92ba6e8880a420c0715ecc77133a5cab98887247c81e58fff8be45535faec1aa4cc350df9d07085dd51777fcb30e0aea4982d6485e1de6b4d01c9a4c745e0262ce35f3a884d9766bcc68ec120a1bf45ec94ea38b6bf6790d3edfa6fc569264e6e74272e5f72bd4d708d66316cdef25e3a48152594ace5bdb02e5a8234ef38f946650276133422861dfc9afed4b323bff91d13132d92bd1a3b422cf6f3f7d69aea373cee58e8b7a384c0e88cade4a954cbb7c42807f94a6db266be55cd7dd1ffb931731da0bbf3d7a503b526bf981d845f265db09ad14cd3f9cbe9f470fa5ec465d67ff2184f03c73666f99ed86c84adb68ad37aac83a97cfee4a255a93ee9278095e5913e42e033b253f7de02f78b7e647008a88f4a288202c5551abc73a07b61b4a9d20214c33ea564e0114d693d21c7c943036c6228e97b355b01df76f9495d4a4dcae579bd022d01236939ca04c6dffcd94640c9d82ce97869e926559f8b6a4786d886468f65b1b023b8e7ddc233f1efb910a863b9a1aff3096fea57f0e521a50a6c9079cd8f63e46e5f9afe4a27e612e29d87663e6f1fe01bdcfae2dddc7288d4cc34c5da69c6ef13e74fcbc26617e5993adf398e18f4438f8fc352a35ceef9bf46e66ac8adfb487b163a1dcf0b94c47bb83f3bad8c059dbbed5892b64599d87429402ba3b36e63b89b8c69a246df65b9433e391eaea690985601ebaf6c1f93b3c86d5408410b048f40d11446fa104117f4e294fe83da4fa7c08c45ea05a90362538576e29397475dd5e5d614eb3a83d51bf0cbf9a621d768c21f9337a3f85d1b8340cafef47d48cebd99a625db8d0300adb797e743bb35d78615aa1670edb316210d7cb46cd7fd262f146f7ca385bf944fefc4634c3f9ba32cbbb3922079f954be79bfd1a96904efa1c9372002c0b8fcb33aa63d9f62f003ff024102f3f6c54b07627a8f761da01828d7ba6ef7379dae740c36deb6e411cd58613eb60bd7a7c834440fc221002591710a663b02d05c922023cc9d5039cd4db3d1a0c37e8811480fd7269a2bfcfa60a74ae7d9f930ea9099398d041e1ecd37d5e4cdc78451d1435130f1a78edd1014d021b08a33718978ec973ee5ae2b059df7b296eeb2c944fe062dc6bb3952fadeccb874b3119f5b844260d90ca50d56a40a1b2d130731c054475958bc965febf8d190f72105d39641a725b8bfc7a822b04324d362204f67680188c325d284f0984b636df8124e294ee7922090ee278a67ece97823266df360f399a8d91061fb1afea8b0c8ded52c090870c658101ffdefc56d16a7ae558672fa305ab8d94a974d5960ec000e716dd18f3345fe64f0087615dc50f92353ead6fbf6d516a6aba7648b105ece3c3276f6869e1b0c983cda0d66c4f048286865defbdd41ad1a67f92c7d304616e84f1c816c3f22bedf096880cc4e80a2f735fc4255eb2c65fd3e8a81b52ec2c6ff8b93fa3666a1e72e77d1bfd8cf2a81e2b6b8c4071c456d8caa01b932924b58924fcbc582e03db5a346823818abac6754a6bb880f3aab7369b1a763066669458b964b3965dd6b329e43d8862abac2ebdb03a2b9afb36c4d52c8110a14f8119a12d29d3324b9f4ea0e798b34c694a528ffc7689fb0b3b3bba20fb972ca03ecc41923e52bebc0fcaedb01f4252358079298cd7ab93d3b8ed1ba638459585b38f9764c8b6fd802492055e1e3b55cfda09b933037ba492a8a164ff0fa85c1861323ec8cf9e005749e3e2b71d22ab9cfaf5c6ab539dcb5e29c57a77f275c789c8db5f40f4c06da441d9d50baaa872d6fd7fb71d6c4746835dae67b4517a1d65b4b9453eb20c98513d9541912195d0a5c583bfd05270680cb61d320a31d5ad4a5327767765f05fe79c5fe07738bc78d290ad424a2ec4c57e71c213090d7940b0de6267e9dc6531b8e1721c72ac24f7ce37cac6f80fdfc75124082c0006bf69d4096c612f3353fd4caa02b28aad3532d79f233c1740b6c0877811d4179f95b7c7b7e957da9fa0676f8c617e7032c7958438fd536f6385fee57be8d778c267cc3a8e3f667be068f6c807609b1ada28fdc39225ce6349582af664d0607d1e9594df6a2d0e869c9aa56b69c374583aca82dc3a2a89509cbf8b3bd39190a233dc18900477d0f8bcd602c443dae0df5b3922b9a44521b0ef6d831ce094dd8fae3a7a307a56ae4167fcc2125714dc1c554c4d3ee5bfefcc754b73dcbfdf89dcf26c1f5ea2923bd0cf7f32f427d995cb0219a04d35ab59494d324b50ba3bf19462f9c7ad87598144e327711a099702073b2591db0ae03b190bfcda35551e8fcf92dba21a803ed680ad6a5d4d9a95ffdc021a8741e0f91b73ce75c2dfde47df754b2b30a822b82387b14249711fb0d9cc6b8cc682e78d7ae2cc99670cea98c9365a6095d9c37b0777dad64552b4c1936f3067011de98cd50737e005f134ee309e36a73fbc7b700415dc4199589439c03fb9470ca192cad73f040df7da4ba560d5417838d01f3efc4b25cf10a844a3d0a9cdd407b527009299b5d97b764644337ded5aa4b5b4c294426cbda84f747a671adebfec58796d2c7aca291e6fb34b95aa76016780551c0acbc60b97c83ec85753ee87aaf1309d6330345deed95c2626ec8391bd475e28d9ccbc8ef68ec0383fe2aa4177e63a34d4c1ea84e7792fe9d711d97d025e3f9fe7e3b29ce4ec5950d6542371e33c822d233410e2ee6cd9092c5e4350410bad0362b8ede00a0c7810f878deaec57c243406611ffb6e4c154a455ad53a5c332a9eea38755c9b7d5c575ebbb7913c1c54d73a2ca1e89e526f7f056004ce2a478421c538e42c33d229b33277de785f0fe28aaa3ba8d869ba224e48d726fccd05143e550288f8bcc4c9db7c69242fd93023938fb454a417c6cf8585ab5616cc42f424eb37d88cba54640ceb18ec852e06a1ad8fec952db248d77b26abc1d42fa93e7c58039d00bcffba7519ffce5c8430745857d7febe34a34935d196614771acf6c003431645c81d53ec6341fb5efeea4cb71c2e83795bca1673e227825b98a7175b9eff7daeee9f4e30b8c58ed41482f2f5d942931d36060fc421feb54a9f0f73b29197155ed5e7bb8cf27d42a8bb3be39c7c168971b39d730d5ae60985679826556d7ac0e2051258fe87bab2eda630abd39244baa7d26239a6303b96e324549246453d603dbe980a0e90e6642a988ab983c196cf1687ae8520116c48fe5c381801e22d3e53a65311794a654afed84a76bb0934e77ee7170f030f079687c52d451e9eacdd9bc40cf01288db277bfa908ef74b9c24259fff565684545df1ee54bea387d2c0e86fa86b564e27b60e88c86fdd86c9c02f7907d4ca71944440d3a08504c15d86aba17b3cc68e9da1e8ad00f19504e072f67fd28a0eeed7ed26e4bc44eb7e6c7faea7a56921db52bba9a6a4e8fddfd6f331c1c34400d2374cca0fec9981aff7d6910000519f7f1313b35d9ce9858741ef5709b3664a2adabb672113811ed6b3eeb0ba664376c94b7905f4830a1fcf46f5a1ed602e9692cca3a67805743094e212fe3fcca4d8f0a5d79cd15397f775c5d62c1fb5e388223ecacf1747128c36901bb99602289138146603f5e35c410c71fb33c01ca171ce5170568ddc14969fa697aa1752a61b0674aebec7360870cb914c602ee36590210b4fbce9e18d9c87cce54cfbc417089be3c2fd2c6b96f468e3eb4400f6b6ea85fc37f35e480e3b55d1cb9e0a3ffb7e70de088dcdaaae33f9f61e60394ff43fa97f1ba38f8fe2e1fb2df8af17e30f6241c572066a52f1e0b11fbf9dd2d0eb9494801782d21b0bc7f373e5ed9aa626bdfd1fd16dba7b6e6bfce1426b78bfb6042bded6846d884b65cbfc28c39850e4341118deda3137847eeb7ae192942f512d88edbf9374296296f025395e5c2dd816a6db744b10ff9ce1cc94c6c6943fcbe6a23eb6ee046b59e281c93af45e0079d839cb17a118d3791bbad8fe4a7af606694a531efa9fde9ce194e00a566cad8634f4d223b5e5aa9264a34ccd64a9c7931753e7ab1555d915d2861d5991ed23f1f62ef6639b49f5043114caf3931090295c152497c34d6b1061d8d4d816288c1d6486f69275907e36a7a850e71b35a8c40b63724ba80a7ac48d70a4aca74288253136d97c24ee62728686931837d98ad374dacbae7eab2982a26594195d0ff43a8d2a62a859b149f7463dbcf421cfffa4bb47042aa3ab265a77c65dc417d3308674eb48f67a6070a571f23ded93967e73d12c49f23cf5ec0538e236b1554a75337a1bdd20601d8ace243a51b97a14fa76aece01f43659abcfa9f99d1430d4e3da725c5377ecca539c7af38fff317d6221b624cd2d3cd31c67501b43657eb3e4edc8576334852ca990effd0fd846fd951f326ad0496f0a1f176a66733be4eebd81263557f465229baa20f2db9a99d97f126892e5d06af64e5a881899aa885b242c01cf41a320b4ee37abd09ba0fa9aedcf31556cbd27a631f8769b2f67b065e03bbe443a6ae8da6a179963e77cc9db15111d0a150f961501337d8c3739b799586bb51530938537d167b66f10aff37483841c627308335e62e25b9a2ad9caab47736e18023c03205d375b6ce866c58e3712864b06d3df783c9c8c5803627a39c5d114dc85912bc1a414a477c29e6c68ef438799f162ee63e5423e7077dd585c55d62f677314a0f7d7c5c703088aa02ffdecd1f3da6506dfac3abd706cf0d7c135ab4d06d3b9573821c5fafb8df524ee277eacef2b6e07d0b5653f50aba1386dc7988c7f61f8ba5799ae1b1980bb4d2e81c47fa5a2c800509681db13681c57897b87fad630d075bbba30af592ea933ddc0b87a6289d72d1be92796f195cf78c739deeb4ee58328ee85f83625ad3cf0bc1331a18e379144d9abf3f0154f8fad0fcf91698684678084242c018539adca6c69ff244f8a6786afa121b8659a5f1da2846f34d36ca63a41a32bc8ff00a724501cdf9f56a2a382056ddbee0ac18a7cdf86ff8a92ae943b698f9f8d1d0ff087fb0a46ea6b88bcac0d2e377527dd0def117da1c89ae7a3e18334039f4c267a3680f451d29826d1b4242063c0c5d2d93b02277d9809f2fb1bccff4b21aafbfff843df8f910e6a12ac6ba9b0b7c46ec329250ebbc6ecb32931be720119a0540743e5e3bcc8def313166b2bcf95e5f3755d3373bb78a45e91c8b626c217394dd878db0627b5d9e158365f8646f7e066903788add6c5166307fc74bc2ff0de176d76a05ccf6ad25e0bb28ab458ef745d3da368fcfcec398f9d814d88a3208851faba6c8334ad163a00677411ad63f0db7f466807c09408a189f8b777dc8746b1aa48ca477ddd264bac1ecfb09139325bab66567ea660abb92db3ace31402677fcd8c1f35e75285d37f73947cf145653da073ed847057c5d87a37424346a225f1b8f83386ff4da03e898c7c220ce44897509267198d30e68d128d3e5390692e18adef52b5c79f299bccd03c113ac6cc299c711bf0fa646be1e2ae0902051ac71dde5c2d0d8d27fae818659beae05defab74f65d8e0ca06582d1ba58c635052678fbc29e5d1afb9c3bc5fac06844d3e848fa9ba01379b45cff2b70f77ae1a091f7a3b98d06dccb5413978a8fc24ffef102c627ddd0e497057e06a3d5bab74bb5ea40356e3398c7cce350d400fb81b5a757c5d89ad57743053910965669442835ad31d0ca59b4e34d5ed1fe0b71d609fea62800e2c8cce37f2a42b61c70673aba892ab9057a3db4f3424b3541777f33211c637a6470724a52da896c80236449e7b3b7923368d10b858aa59db61c81b99ef1450624fbf0e224cee4eddc6baf3326d0b94584e478f5196c2d15aea516b855d9be1e22c53c6c4058e4f38cdffc3946ebbb7fa78d7987504fe99ee81bbe89b2ae905cd14f34d3b996b7a338e82c657315454d0fc55ec51446cdac4f752cb995d75aea76e25bb63bfc4f657b70438f9f7448ea314a6790ae5736b2ec538dd6e68ad1e0011dff3133918aff1e0bd96a61ecd84b9633c55037ef04398c1e9a87b868664f67e206e8a5ca684a40bc215f043b56e5c1cd5df771fddcee40e078c17793f7ce72c71fff4bb1eb8802904ce6413f6a7e24a1cd2569bbc98090ab2d37926607272889d5c86b358656bdba36284d2aa4ac1964099fd1d8def5c0f2610c160e56ade85606863b500f12e61bbe9bbd8de7fe37cbcad19b0e54a3d550cff4a68662c7d1258e2ca7ef4554614bab0c0bf56962873c924cf6cbbf4db37faea29a3ac8fd58c264ecdb474f1ff3a962aca561b14db064fca16f22f0eef2fc5b781dc8d73de4542ee7ce281f1525766f9d5b0a08d88c6efcf7b82b858ef31cf273ac4afffa89abc003cd73beba12e6c5f7ded0986729de65c812d82bc1b37e30f10682670692be21bf63cedd8d5a824bea5e0e05fa1044cfdc891afe2679eb77ff3b9b82bfae56d9711a49f91cc8b838c6883549fa86ec881f1540aa4591c09715b9f724032318c85bb09d560058974519f521a3209463c4c61e8d0a5babf29a01de840b239e545ea84eebd57ad715f10e104e9cafb34c635b482fbd432a7c490c8c3775b68062d7f569e139ee664ac0893af935ed504dc0dca1ed93164ebdee67e5da5de1db09889f7fc138b428e9033520680ba8842783f61d349032f042ee67b8ff67a66f8bf858e40a270d4b9a11629e11fe08441bfa1f0edf609df7614ec86beac4302d6e8897c356964b3f85860b983efd393a7c599506610e305e5f62426dd3c7e16203a16668aea3c7c7797dadf40c973533b9084e882118a1a78738d59c2d249d318a8dcc165b8d2603fd8152e91f7d64db2c9dc3d708be8ed4e96c3c068b07c132af5bf04f8bc7c87ad246454fa3847c8b1144fa3f952d985eafba8813f5fe0e1433ac656009399557a10c40a74c44108067d07dd8d14b6d57f4bc07e9bdc8d2695df30d0faf7ed0e451625f552f792e3270e68cd19bd2bad50e37bb957b6764b8bfce9f0b5268e0ec4d9b5f67254fbc009e1b85bf0fdcd77627dd40c69dda92e0edaa95d7bd67ee281cf2b881d3af78a40bece5941b7b219519728558a6b7e23f3b45e12928d11d51cd0f748df6f8a3491892d924ed3f85b38ed94eb48896b1e83c8b7b0e438f20a76747efe6f223640f753113efbd5feaf60d1636a01d99cb68c09631eea7cf4df0772977e06dc39bd20ad42a66d448a0cbe61a8a6f4cbfc841619a8cab413fb9642e5f281879c60e2a8ff812a3e2ab5ae41113b2e41e743676d574c548d69af257d693c4bc313778fbf85dd818b35c21608fef3229f683f4acd1aa446f65f5caf9aa726fbfcc9ff1cc10ec3a1c79e2fd2f9cb1c932b77d840ca96f80bbf9cb8d0f5632f12e5d0bce66d5557085ed9e0ab7fdc845db6b924e136b0cbceb083869af2fd76db3305161025d0fdb4f162211f8f2d8e54bc484c5f3606df6dab0050fd354c1b820073ad855ffae3a5a5e4a44ab263eac6c3d6c2429fbf5272bb56a7e4cd5ea4965dc00e8bbe4d140b0396e50d65f76bf5afae3f3027c7d603be9153b7bcbd7f020c8e271291553b9a859ff41325f2e99daf181c4b11f82625cafe2ccda718a1a7fda0c30fa8819fbe7668bfc961258fff96f3b9ba00e7c7e7115cee41b1bbd0a66fe382603428ede6c6dc0fc7bfb0ac93b9f65faa1a3ef8c1c904498530416e79304c1bf0897dbfff905530b8b4d3f96a0932ca6e257cd575077601c0d3daddda034d1459e4dade95b9cdfe33ebb49923a6356d3f7423834aebecf5ddc8fedfe2dae952563f8dc204d70a1be79bf5f7b47b9d2f950d6ec538e236030051db48865afa30c7b780090776b91f74b7defec49e3cbb98600ea53798c78b8929be22b4413921aa67722c3d9970e7c89d564ecfb33a579bfd18b94a34306a40fdbbabf2c939e41b4ab463b858d621abf037e46fc6b472333fb19d6e7f0a1dafb9379b10ef19ee7cb3f96ca1984e8acd0b8cdfecd7c340c108d08c7c7e13fa4cafaefb26b2c537d05f24809cea079b3c1a2fdae847018347e3a214cf4b41531081d2e8264f0c22b0ab98bb6eea20137d840dedfef2f5cd462fca5b764c1d2e68a8b8e96f893cd6bbc699a8b24a1c1a7a245831441178be5f76b72e612407cde1870ff79f5e79e7d322de6c6e564bb8015829ba70718cbc9c4baf02f31e373ea2ca7ac8feaa4c7ecb247ee0c61eb1f567f5b79c5e619c08ec6119fda4d7ffd320fe91728897ec0631800a589be3fcf2d1cb03de710e16571708d4031db1441ed71a2ebdd594af1c1868e885d45a0ce44fc5f631db4950d4c818451ee69c613d1a5971fd1c33bee484cedc56570ee036cc4b56a0c76f7c63a8a2e8f0dc87bd50583031363529ea6635c5763318a7a128160102462334d70f40d80810ce54013da2a611e5b663f71443a877740f368321875e90656be86a7e36f3e568400564ba551499019d1ae70bf06f1610ccaee0089ddcf570484238872730ef9b28ce2b7e5f6c270fb19e77f638f12821ceb8b06a0e7da1465e38b319fbc3114a639573888ed845a2e561cbc59f8f0e8130731aa6d3b82b163c213687debad2ad0132bfd5ab3b2881d1deb9ad0826e3fbbee703a3d4e19d6424119bd45cc2f7d3e1b85755c539a61ef4085bc5f766e6039385a4a9e2a45f98538642d011b7fac45fade302c22960c3b61329991719b6ba37618f1502a504a4b7acd0d179dbe320fd6246d021252779bb709fae88f5e703d87fe0e3278e1a58a8a3bcfe5438dcc8bc263d013cec65fed756bc55652fa180061e76b69427e629d7af58260fc7d39855c914fa280a3e2a7d289aa05ab997c7ab28301e1f2cf6e0bfa2f31cd65b165680653510622b3c4c07652db95b625a55fc454f89079e9bbb407038e6ffb76b511464de30863ff0ca559e5f374a80318a5541562c0cd3306ccb3ccb53d7fd69ee644f75795ef4b4e5ccc77df45f388c66a409a1daa5edfe5f27b57706e396563ef290973d8f868792cb43a72a5a309a970a1fc741f21c8b0e54f91659c8a82484339cf42d455c7936a5d4398ba45ccbb0c2a11ac356cbf2ca73c13b9bfd8e7276dc8121ca337062bfe2641e4ebb20f2c878649c46543281b3535bf4d3a82b4b02f4828b2f32f7f02764bf0b5e63d51f0cbd04c33fe2c219e3a38dd913a6bfc1700395976f3c3048d53f5bc3f1478578909002011c4384b2ba9347c584a58c1c324a4af27d9614c1dbca22f3ccd7db39e82702497bc550e13aef78a745818e078f853c980cef1318786037b67a315853edcbb6ef653a68ceda57a5faaa0960e5681791ad94f4edcc324456b1e326d68ea4c8a51c8bfba619cd7fdfb56d213e33d93c2dc44369a0f2ed91c697818fa46a55b634dba7a9e088043fabbadddfba64b43b7fd5feafc17fddb4c6364884d7ac35892fd31ee35392bce96ba7c850ab26a5027420a5f0d3601fab3c35ca5e704a4535077a00e83f1d6ce9b246544d01eb5e08584158baabc40558c7390b296baa957a1cff9fb555595fb7466c2581bc1db420d29f33a678a4e4b5952241cc47e40bfd59821beebbe4c14a40b95143e21510ccf4cdc91773229c41e481deb25a7cf93b627c95825d3a0d2edceeddb6f56ccd05c37e2721c29607e5728c467cad7e9a6379e6f085c23c5085325a794bc7ff3c0d685f26771abc010aa8efd91f978dacb7f2be97447d835accbc76268e5a3d152c225cbb6a76d999dd59cd54aaa539bfe9730dbaecb0594604cc1b22e6096211e005079affb6c9911228d6a2cc82ff7dcc8fe7664cfb8356d7a625b766c1bfb48974b369d702df76319c4148a91079d0a0cbd28446d75e82e8774a97e9c1d9483d9d5275407b2debc6aad46c92744137bbf809a6f566ccdf38fdf09550b5aeff8b73742f691555f303ed317a76ed54d3c43d45eb8c38d0cf41ff9c41ca7e7e8b32ff2929c8ccaac83b74ff4c66c8fe717ff7bd151e8d20edb6b39fcbeb2a908c7ca0141a9f6fc9e5f85cb36b5408cc8524e040bb884243b780ca3349fb6ffa737dd9e36fae3b914334f4a24886e434253b18a0bd191c314307b29397c14450831633dc828a8ff04fad647085fe8ac52256a3824521d49fee0e862ceed125683ee8386148fedcb449ad9b2cf6c71b767298dc025b31ade2fd0bbf25d7f1da43336cbb3de1e68a451d8a60580c9c28f415ae515c89495bb8779af9adb406fb093fe5273fcaa1517a9961279f2a7d6e719e19135ceb118e956eac2ce7c5996a8224d0d960ea63e1f9ad5753ba711f2fb915b28da86c640158e22b908a9b75d034c725057627f82c4dfd3e6a2494e7fa3dc789c12a202236e1c0a643989f9cf7c86b2690ae5ed039a9a52e6f081d23a745d29676a7c521e9c89522150ebe95485b548dc6625c3caee28df7976061467f51793a4b25ccf8cc28b120d3fbc246b7c40f423be68e3462ca4c4591d6804f849e9be02703c97dc571a7a1c1e9d151fedfff3699ef8633df9c296b2f976f37581eebea92896f8dfb8b30a12499fad662ffbf6c997f4786f132bead17a555c891ed78308d82bad7719a62e014923f64b8b915b8ccd9d2a698d9e9b9cc6764d3139fd3bfd4650c618acfb1383e5303d5eaf7cdb90465e540d0623137e4588fe73d943b9dec5787517010f5046b7235ebffe94d933afd15e23ea472c6910c6a4f3dec74d54ed1fb89bf75d375273655b3d57839545c46a06df873b964197ad502b2e64f9c5520471f0f30207f712b0cc6641f9e050a4aa5e75a7260382a329c51aa51eff02a27a33783259ebce4000f581e7811196bca0a02cfeeb7244d3b908904ad55d6dcd7105aad428f2d1dc11758e24fa2b974d869a6c5eec88edbd96282ce4cd04011aba7f51d81fe850aec189a80a863687d186af6b39a2a9186062488ff3a9c9be27c70d3b1833bd044a842a1b49cfa7adb93818da74b04840e2fae83628384e17d8b7832b76efc96a81f5ceb3135a30c7be874c81ac0ad75be4e4dd96a10f5f01da16756b86b1dbc4f3cda524aad6752432d4123334bd04d3806e85f79f040e6f03caa5b2a81bba6b39453590ee2193f38fc8a98cca96c5d56f270ee14589b1eebb928c3be5750fb12d96271fe554488f5f8261a58220ab6a5c6c9f612f6022f5a212190574a78dede657998aa18b8f610ec7bc2b6238f985d450deceb5d8a216d690df87cc5403894845d8dafc797eb4a0982b60d19a912ae6192d490fc64e362a093e10cd49972530c7b88cd39bacb64d103bd34df324e84afbc5f2d487e99a719f03269275219de5619d34c0741d779d579833eed1abd5350d6d5d5bb14f05bc314c267dc4ca02f1f9bab2a219c9a39a7e667548eea7f5b713af71026f55399e258e1a2f3b1dc4073754ccd21c6082b46d823fe2850ca2a2941cc4ed70bb53488f6f5e02204eea1c62c6fcf9e5bac9e5efda2685bc1533660f5317328323a156de14957efcc44906a9be3b569baa2ac2d0661bdb984883a0858d1e063c462a81780284c871500cdb8e6f1d09362527e727dd9afe7d81c9e925458013231ae5b25b2c0e1d78362e468c6cb366b0e00344eac149ae3a18acbb0fbe8be8d53a489b1ac550d88124b281d4f749605c021435c06f660a4526fccd504d269b004abe530d9c3a3df74df49e1287a2ae09f100920fceb58dfa251fd5017f7289246430ee6257a628de65a1b8cac5044f3b8ec0e6a225f3b98fa3df84ed9a093c1686bf9a53642d22f830f67feb833504564e0a53686f7dc37637f38ebf28025a1d55ecf0e136265ad90ee7166f7926d83832cc9c8c3845c38583b3f2a5f42b268e09adf3f18cb49c94ee2e5956db0bd829c9962d087c2ea67f996109a1800ba8cf327aba01a27b78c47f688b16cd4b455e99b02ec50c8b9c5b03b6086b00b41d14132076159b304295cc25525d9309fa6bee5523ab67a6a21ac6edc45ce61246bec08aa05aec0623fa64de02c54b2cf828c56a616e7d4918fba4f897d6edef32bcf06de25fcc2542715c86923f14b89378ed16115e4b698730f250c7efa222a04f78447ca0f41090e775e4ce47d0bd2a721cbf438cd61ab1e7d428d647805e2366b1c136ebcea9e78888ea6a2ae8f1f2aa95aec243913319eff21eb32e84e45ff266c8f2b51df63510a3f87fc936e422";
        System.out.println("SendData: " + utils.hexToAscii(encSData) + "\n\nReceiveData: ");
        String encRData = "000000000000000190adf94c9b42efac785d7629d5da2ce4b6268b1a39b65ac6626e4f053c93254ebbdcf43724b20d9d0a3eb399efe41ffaa90ee861cfff6550091cf7cdf2f407774d08e520dde3c311d984a23d61973874c950f68f7aedb368b50badec681da5e6ed10002dc5fe2d01d13fd52aaea50db98112e98592f6dc5aad3921695919ffcc8506e6831537ebad6d4aab4f9f15cfc18a9fb2ca86ed7f2626a072c32baa582682d78b4f914c725802ced9ad60149283862e1eca1fc1659d039aa4afc09bbe8a4ab989f98e48df2c0077214379615d8b1b4c68aca4cf2fd42c1777002e20c3c9973ded47d8c83caff5ae9199b693541d5a13b0de36ec4655455df21444a8b454512bb1c10b2c508bf28efa8ec81b7857d105a3b35ae731581df7046e342e7c7828c21335d6d22eb2b727dea3a980d0d1f32ab4a99a9e33cf172c0132b520a16e5b6e93c8151d42b0379b2b1acc95277e4a591db15be6a6e1f945d662a11626790df8c17ee68b012b043125adb902f8a2ce58f707f05a4ab90dc22b6df7aa6c7e52c87bdd382fc45cb541601046d4e55698cf6b0318bb2d207100296faccfefb1ab763f3b3736633b666465b9df5c658fc8b5218f6fddb1b65cba954879e0f48a17087cb1c1ad118dc6ed16b369933be956e359745ea57383d5a062580479a78a53c44d9088c5a8c3c987ffe788cf17263e915c086eef676c04b66ad16a952492214ac10a63";
        System.out.println(utils.hexToAscii(encRData));
        *
        /*JFileChooser fileChooser = new JFileChooser("jaas.config");
        fileChooser.setDialogTitle("Seleccione el archivo jaas.config");

        // Abre el diálogo de selección de archivo
        int returnValue = fileChooser.showOpenDialog(fileChooser);

        if (returnValue == JFileChooser.APPROVE_OPTION) {
            File selectedFile = fileChooser.getSelectedFile();
            String jaasConfigPath = selectedFile.getAbsolutePath();
         */

        // Simula la obtención del nombre de usuario y contraseña del usuario
        int port = 1257; // Puedes cambiar el puerto según tus necesidades
        try (ServerSocket serverSocket = new ServerSocket(port)) {
            System.out.println("Servidor esperando conexiones en el puerto " + port + "...");

            while (true) {
                // Esperar y aceptar una conexión entrante
                Socket clientSocket = serverSocket.accept();
                System.out.println("Conexión entrante aceptada desde " + clientSocket.getInetAddress());

                // Manejar la autenticación para esta conexión
                handleAuthentication(clientSocket);
            }
        } catch (IOException e) {
            System.err.println("Error en el servidor: " + e.getMessage());
        }

        /*} else {
            System.err.println("No se seleccionó ningún archivo jaas.config.");
        }*/
    }

    // Estos métodos deben ser implementados en tu aplicación según tus necesidades
    private static String obtenerNombreDeUsuario() {
        // Implementa la lógica para obtener el nombre de usuario
        return "admin"; // Ejemplo
    }

    private static char[] obtenerContraseña() {
        // Implementa la lógica para obtener la contraseña
        return "admin".toCharArray(); // Ejemplo
    }

    static void handleAuthentication(Socket clientSocket) {
        try {
            // Configurar la propiedad del sistema con el archivo jaas.config seleccionado
            String jaasConfigPath = "/Users/localadmin/NetBeansProjects/Xbox360S/jaas.config";
            System.setProperty("java.security.auth.login.config", jaasConfigPath);

            // Simula la obtención del nombre de usuario y contraseña del usuario
            String username = obtenerNombreDeUsuario(); // Debe implementarse en tu aplicación
            char[] password = obtenerContraseña(); // Debe implementarse en tu aplicación

            // Crea un contexto de inicio de sesión para Kerberos con credenciales personalizadas
            LoginContext lc = new LoginContext("EmulatedKerberosServer", new CustomKerberosCallbackHandler(username, password));
            lc.login();

            // Verifica la autenticación exitosa
            Subject subject = lc.getSubject();
            if (subject != null) {
                System.out.println("Autenticación exitosa:");
                for (Principal principal : subject.getPrincipals()) {
                    System.out.println(principal.toString());
                }

                // Implementa la lógica del servidor aquí
                // Cierra la sesión cuando sea necesario
                lc.logout();
            } else {
                System.err.println("Error de autenticación.");
            }

            // Cierra la conexión cuando se haya completado el proceso de autenticación
            clientSocket.close();
        } catch (IOException | LoginException e) {
            System.err.println("Error durante la autenticación: " + e.getMessage());
        }
    }
}
